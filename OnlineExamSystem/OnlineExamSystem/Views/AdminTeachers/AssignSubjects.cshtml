@using OnlineExamSystem.Models

@{
    ViewData["Title"] = "Assign Subjects";

    var teacher = ViewBag.Teacher as Teacher;
    var subjects = ViewBag.Subjects as List<Subject>;
    var assignedIds = ViewBag.AssignedSubjectIds as List<int>;
}

<h2>Assign Subjects</h2>

<div class="mb-3">
    <strong>Teacher:</strong> @teacher.Name  
    <br />
    <strong>Email:</strong> @teacher.User?.Email
</div>

<form asp-action="AssignSubjects" method="post">
    @Html.AntiForgeryToken()

    <input type="hidden" name="id" value="@teacher.Id" />

    <div class="card">
        <div class="card-body">
            @if (subjects != null && subjects.Any())
            {
                foreach (var subject in subjects)
                {
                    <div class="form-check mb-2">
                        <input class="form-check-input"
                               type="checkbox"
                               name="subjectIds"
                               value="@subject.Id"
                               id="sub_@subject.Id"
                               @(assignedIds.Contains(subject.Id) ? "checked" : "") />

                        <label class="form-check-label" for="sub_@subject.Id">
                            @subject.Name
                        </label>
                    </div>
                }
            }
            else
            {
                <span class="text-muted">No subjects available.</span>
            }
        </div>
    </div>

    <div class="mt-3">
        <button type="submit" class="btn btn-primary">Save</button>
        <a asp-action="Index" class="btn btn-secondary ms-2">Cancel</a>
    </div>
</form>
